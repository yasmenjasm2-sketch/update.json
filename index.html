<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ | Ù†Ø¸Ø§Ù… Ù…Ø­Ù…ÙŠ</title>
    <style>
        /* Ù…Ù†Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ ÙˆÙ†Ø³Ø®Ù‡ Ù„Ù„Ø­Ù…Ø§ÙŠØ© */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364); 
            color: white; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
            user-select: none;
            -webkit-user-select: none;
        }
        .login-card { background: rgba(30, 30, 30, 0.9); padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.8); width: 320px; text-align: center; border: 1px solid #444; position: relative; overflow: hidden; }
        .login-card::before { content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(to bottom right, rgba(255,255,255,0.1), rgba(255,255,255,0)); transform: rotate(45deg); pointer-events: none; }
        
        input { width: 100%; padding: 12px; margin: 15px 0; border-radius: 8px; border: 1px solid #555; background: #222; color: #00e676; box-sizing: border-box; text-align: center; font-family: monospace; font-size: 16px; font-weight: bold; letter-spacing: 1px; user-select: text; -webkit-user-select: text; }
        input:focus { outline: none; border-color: #00e676; box-shadow: 0 0 8px rgba(0, 230, 118, 0.5); }
        
        button { width: 100%; padding: 12px; background: #00e676; border: none; border-radius: 8px; color: #000; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 16px; margin-bottom: 10px; }
        button:hover { background: #00c853; box-shadow: 0 0 15px #00e676; transform: scale(1.02); }
        
        .whatsapp-btn { background: #25D366; color: white; text-decoration: none; display: block; padding: 12px; border-radius: 8px; font-weight: bold; font-size: 14px; transition: 0.3s; margin-top: 10px; }
        .whatsapp-btn:hover { background: #128C7E; box-shadow: 0 0 15px #25D366; transform: scale(1.02); }
        
        .error { color: #ff5252; font-size: 14px; margin-top: 10px; display: none; border: 1px solid #ff5252; padding: 8px; border-radius: 5px; background: rgba(255, 82, 82, 0.1); font-weight: bold; animation: shake 0.3s ease-in-out; }
        .device-info { font-size: 11px; color: #aaa; margin-top: 15px; font-family: monospace; background: rgba(0,0,0,0.3); padding: 5px; border-radius: 5px; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
        }
    </style>
</head>
<body>

<div class="login-card" id="mainCard">
    <h2>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
    <p style="font-size: 13px; color: #ccc;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</p>
    
    <input type="text" id="subCode" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" autocomplete="off">
    <button id="loginBtn" onclick="login()">ØªÙØ¹ÙŠÙ„ ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</button>
    
    <a href="https://wsend.co/905424678123" class="whatsapp-btn" target="_blank">ğŸ’¬ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ / Ø´Ø±Ø§Ø¡ Ø§Ø´ØªØ±Ø§Ùƒ</a>
    
    <div id="error" class="error">Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ØŒ Ù…Ù†ØªÙ‡ÙŠØŒ Ø£Ùˆ Ù…Ø­Ø¸ÙˆØ±!</div>
    
    <div class="device-info" id="deviceDisplay">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¨ØµÙ…Ø© Ø§Ù„Ù‡Ø§ØªÙ...</div>
</div>

<script>
    // ==========================================
    // ğŸ›¡ï¸ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù„ØµÙØ­Ø© Ø§Ù„ÙˆÙŠØ¨ 
    // ==========================================
    document.addEventListener('contextmenu', event => { if (event.target.tagName !== 'INPUT') event.preventDefault(); });
    document.onkeydown = function(e) {
        if (e.keyCode === 123 || (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74)) || (e.ctrlKey && e.keyCode === 85)) return false;
    };

    // ==========================================
    // Ù…Ù†Ø·Ù‚Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±
    // ==========================================
    const REQUIRED_APP_VERSION = "3.0.1"; 
    const DEVELOPER_LINK = "https://wsend.co/905424678123";

    const urlParams = new URLSearchParams(window.location.search);
    const appDeviceId = urlParams.get('device_id') || "DEVICE_" + Math.random().toString(36).substr(2, 9); // ØªÙˆÙ„ÙŠØ¯ ÙˆÙ‡Ù…ÙŠ ÙÙŠ Ø­Ø§Ù„ Ù„Ù… ÙŠØ±Ø³Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨ØµÙ…Ø©
    const checkCode = urlParams.get('check_code') || "";
    
    document.getElementById('deviceDisplay').innerText = "Ø¨ØµÙ…Ø© Ø¬Ù‡Ø§Ø²Ùƒ: " + appDeviceId;

    // ==========================================
    // ğŸ“¦ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ (ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø© Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ ÙÙ‚Ø·)
    // ==========================================
    /*
      - durationSec: Ù…Ø¯Ø© Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ (Ù…Ø«Ø§Ù„: ÙŠÙˆÙ… = 86400 Ø«Ø§Ù†ÙŠØ©ØŒ 30 ÙŠÙˆÙ… = 2592000 Ø«Ø§Ù†ÙŠØ©)
      - status: 1 = Ø´ØºØ§Ù„ | 2 = Ù…Ø­Ø¸ÙˆØ±
    */
    const subscriptionCodes = {
        "SUB-MONTH": { durationSec: 30 * 24 * 60 * 60, status: 1, type: "30days" }, // 30 ÙŠÙˆÙ…
        "SUB-WEEK":  { durationSec: 7 * 24 * 60 * 60, status: 1, type: "7days" },  // 7 Ø£ÙŠØ§Ù…
        "SUB-DAY":   { durationSec: 24 * 60 * 60, status: 1, type: "1day" },       // 24 Ø³Ø§Ø¹Ø©
        "SUB-HOUR":  { durationSec: 60 * 60, status: 1, type: "1hour" },           // Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©
        "TEST-20":   { durationSec: 20, status: 1, type: "20seconds" },            // 20 Ø«Ø§Ù†ÙŠØ© Ù„Ù„ØªØ¬Ø±Ø¨Ø©
        "BANNED-CD": { durationSec: 86400, status: 2, type: "1day" }               // ÙƒÙˆØ¯ Ù…Ø­Ø¸ÙˆØ±
    };

    // ==========================================
    // âš™ï¸ Ø£ÙˆØ§Ù…Ø± Ø§Ù„ÙØ­Øµ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
    // ==========================================
    window.onload = function() {
        // ÙØ­Øµ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        setTimeout(function() {
            window.location.href = "app://check_update?req_ver=" + REQUIRED_APP_VERSION + "&link=" + encodeURIComponent(DEVELOPER_LINK);
        }, 300);

        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© (localStorage)
        restoreSubscriptionIfValid();
    };

    function restoreSubscriptionIfValid() {
        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø¹Ù† Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ø³Ø¬Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²
        let activeCode = localStorage.getItem("active_sub_code");
        
        if (activeCode) {
            let savedData = JSON.parse(localStorage.getItem("sub_data_" + activeCode));
            
            // Ø§Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ®Øµ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²
            if (savedData && savedData.deviceId === appDeviceId) {
                let currentTime = Date.now();
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£Ù‚Ù„ Ù…Ù† ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ (Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ù„Ø§ ÙŠØ²Ø§Ù„ Ø³Ø§Ø±ÙŠØ§Ù‹)
                if (currentTime < savedData.expiryTimestamp) {
                    showLoadingScreen("Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ø´ØªØ±Ø§ÙƒÙƒ... ğŸ”„");
                    
                    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø§Ù„ÙƒÙˆØ¯ + Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø§Ù„Ù…Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©)
                    setTimeout(function() {
                        window.location.href = `app://restore_sub?code=${encodeURIComponent(activeCode)}&expiry_time=${savedData.expiryTimestamp}`;
                    }, 2000);
                } else {
                    // Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù†ØªÙ‡Ù‰
                    localStorage.removeItem("active_sub_code");
                    showError("Ø§Ø´ØªØ±Ø§ÙƒÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù‚Ø¯ Ø§Ù†ØªÙ‡Ù‰. ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø¬Ø¯ÙŠØ¯.");
                }
            }
        }
    }

    // ==========================================
    // ğŸ” Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
    // ==========================================
    function login() {
        const subCode = document.getElementById('subCode').value.trim();
        const codeConfig = subscriptionCodes[subCode];

        if (!codeConfig) {
            showError("Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!");
            return;
        }

        if (codeConfig.status === 2) {
            showError("ØªÙ… Ø­Ø¸Ø± Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø·ÙˆØ±! ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù….");
            return;
        }

        // ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù„Ù…Ø¹Ø±ÙØ© Ù…Ø§ Ø¥Ø°Ø§ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù…Ø³Ø¨Ù‚Ø§Ù‹
        let savedData = JSON.parse(localStorage.getItem("sub_data_" + subCode));

        if (savedData) {
            // Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹.. Ù„Ù†ØªØ£ÙƒØ¯ Ù‡Ù„ Ù‡Ùˆ Ù†ÙØ³ Ø§Ù„Ø¬Ù‡Ø§Ø²ØŸ
            if (savedData.deviceId !== appDeviceId) {
                showError("â›” Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ø¹Ù„Ù‰ Ù‡Ø§ØªÙ Ø¢Ø®Ø±! Ù…Ø³ØªØ­ÙŠÙ„ ØªÙƒØ±Ø§Ø±Ù‡.");
                return;
            } else {
                // Ù‡Ùˆ Ù†ÙØ³ Ø§Ù„Ø¬Ù‡Ø§Ø²ØŒ Ù„Ù†ØªØ£ÙƒØ¯ Ù‡Ù„ Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚ØªÙ‡ØŸ
                if (Date.now() > savedData.expiryTimestamp) {
                    showError("â³ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©.");
                    return;
                } else {
                    // Ø§Ù„ÙƒÙˆØ¯ Ø³Ø§Ø±ÙŠ ÙˆÙ†ÙØ³ Ø§Ù„Ø¬Ù‡Ø§Ø² (Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙŠØ¯ÙˆÙŠØ©)
                    completeLogin(subCode, savedData.expiryTimestamp, codeConfig.type);
                    return;
                }
            }
        }

        // --- Ø§Ù„ØªÙØ¹ÙŠÙ„ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø© ---
        // Ø­Ø³Ø§Ø¨ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„ÙƒÙˆØ¯
        let durationInMs = codeConfig.durationSec * 1000;
        let expiryTimestamp = Date.now() + durationInMs;

        // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØ¹ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±
        let activationData = {
            deviceId: appDeviceId,
            expiryTimestamp: expiryTimestamp,
            activationDate: new Date().toISOString()
        };
        
        localStorage.setItem("sub_data_" + subCode, JSON.stringify(activationData));
        localStorage.setItem("active_sub_code", subCode); // ØªØ¹ÙŠÙŠÙ†Ù‡ ÙƒØ§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø· Ø­Ø§Ù„ÙŠØ§Ù‹

        completeLogin(subCode, expiryTimestamp, codeConfig.type);
    }

    function completeLogin(subCode, expiryTimestamp, durationType) {
        document.getElementById('error').style.display = 'none';
        
        const btn = document.getElementById('loginBtn');
        btn.innerText = "ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ âœ…";
        btn.style.background = "#fff";

        // ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„ ÙˆØ¥Ø¹Ø·Ø§Ø¦Ù‡ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¯Ù‚ÙŠÙ‚
        setTimeout(function() {
            window.location.href = `https://dummy_success_auth_${durationType}?code=${encodeURIComponent(subCode)}&expiry=${expiryTimestamp}`;
        }, 800);
    }

    function showError(msg) {
        const errorDiv = document.getElementById('error');
        errorDiv.innerText = msg;
        errorDiv.style.display = 'block';
    }

    function showLoadingScreen(msg) {
        document.getElementById('mainCard').innerHTML = `
            <h2 style='color:#00e676;'>${msg}</h2>
            <p style='color:#ccc;font-size:14px;'>ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²ÙƒØŒ Ø§Ù†ØªØ¸Ø± Ù„Ø­Ø¸Ø©</p>
            <div style="margin-top:20px; width:40px; height:40px; border:4px solid #00e676; border-top:4px solid transparent; border-radius:50%; animation: spin 1s linear infinite; margin-left:auto; margin-right:auto;"></div>
            <style>@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</style>
        `;
    }
</script>

</body>
</html>
