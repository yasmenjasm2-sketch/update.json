<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ | Ù†Ø¸Ø§Ù… Ù…Ø­Ù…ÙŠ</title>
    <style>
        /* Ù…Ù†Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ ÙˆÙ†Ø³Ø®Ù‡ Ù„Ù„Ø­Ù…Ø§ÙŠØ© */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364); 
            color: white; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
            user-select: none; 
            -webkit-user-select: none;
        }
        .login-card { background: rgba(30, 30, 30, 0.9); padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.8); width: 320px; text-align: center; border: 1px solid #444; position: relative; overflow: hidden; }
        
        /* ØªØ£Ø«ÙŠØ± Ù„Ù…Ø¹Ø§Ù† Ø®ÙÙŠÙ */
        .login-card::before { content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(to bottom right, rgba(255,255,255,0.1), rgba(255,255,255,0)); transform: rotate(45deg); pointer-events: none; }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ²Ø± Ø§Ù„Ù„ØµÙ‚ */
        .input-wrapper { position: relative; margin: 15px 0; width: 100%; }
        input { width: 100%; padding: 12px 12px 12px 60px; border-radius: 8px; border: 1px solid #555; background: #222; color: #00e676; box-sizing: border-box; text-align: center; font-family: monospace; font-size: 16px; font-weight: bold; letter-spacing: 1px; transition: 0.3s; }
        input:focus { outline: none; border-color: #00e676; box-shadow: 0 0 8px rgba(0, 230, 118, 0.5); }
        
        .paste-btn { position: absolute; left: 8px; top: 50%; transform: translateY(-50%); background: #333; color: #00e676; border: 1px solid #00e676; border-radius: 6px; padding: 6px 12px; font-size: 12px; cursor: pointer; transition: 0.3s; font-weight: bold; width: auto; margin: 0; z-index: 2; }
        .paste-btn:hover { background: #00e676; color: #111; box-shadow: 0 0 10px rgba(0, 230, 118, 0.4); }

        button.main-btn { width: 100%; padding: 12px; background: #00e676; border: none; border-radius: 8px; color: #000; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 16px; margin-bottom: 10px; }
        button.main-btn:hover { background: #00c853; box-shadow: 0 0 15px #00e676; transform: scale(1.02); }
        
        .whatsapp-btn { background: #25D366; color: white; text-decoration: none; display: block; padding: 12px; border-radius: 8px; font-weight: bold; font-size: 14px; transition: 0.3s; margin-top: 10px; }
        .whatsapp-btn:hover { background: #128C7E; box-shadow: 0 0 15px #25D366; transform: scale(1.02); }
        
        .error { color: #ff5252; font-size: 14px; margin-top: 10px; display: none; border: 1px solid #ff5252; padding: 8px; border-radius: 5px; background: rgba(255, 82, 82, 0.1); font-weight: bold; animation: shake 0.3s ease-in-out; }
        .device-info { font-size: 11px; color: #aaa; margin-top: 15px; font-family: monospace; background: rgba(0,0,0,0.3); padding: 5px; border-radius: 5px; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
        }
    </style>
</head>
<body>

<div class="login-card" id="mainCard">
    <h2>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
    <p style="font-size: 13px; color: #ccc;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ùˆ Ù„ØµÙ‚ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„</p>
    
    <div class="input-wrapper">
        <input type="text" id="subCode" placeholder="Ø§Ù„ÙƒÙˆØ¯..." autocomplete="off">
        <button class="paste-btn" onclick="pasteCode()">Ù„ØµÙ‚ ğŸ“‹</button>
    </div>

    <button class="main-btn" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
    
    <a href="https://wsend.co/905424678123" class="whatsapp-btn" target="_blank">ğŸ’¬ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ / Ø´Ø±Ø§Ø¡ Ø§Ø´ØªØ±Ø§Ùƒ</a>
    
    <div id="error" class="error">Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ØŒ Ù…Ù†ØªÙ‡ÙŠØŒ Ø£Ùˆ Ù…Ø­Ø¸ÙˆØ±!</div>
    
    <div class="device-info" id="deviceDisplay">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¨ØµÙ…Ø© Ø§Ù„Ù‡Ø§ØªÙ...</div>
</div>

<script>
    // ==========================================
    // ğŸ›¡ï¸ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù„ØµÙØ­Ø© Ø§Ù„ÙˆÙŠØ¨
    // ==========================================
    document.addEventListener('contextmenu', event => event.preventDefault());
    document.onkeydown = function(e) {
        if (e.keyCode === 123 || 
           (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74)) || 
           (e.ctrlKey && e.keyCode === 85)) {
            return false;
        }
    };

    // ==========================================
    // âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    // ==========================================
    const REQUIRED_APP_VERSION = "3.0.1"; 
    const DEVELOPER_LINK = "https://wsend.co/905424678123";

    const urlParams = new URLSearchParams(window.location.search);
    const appDeviceId = urlParams.get('device_id') || "UNKNOWN";
    const checkCode = urlParams.get('check_code') || "";
    const appExpiryParam = urlParams.get('expiry_time') || null; 
    
    document.getElementById('deviceDisplay').innerText = "Ø¨ØµÙ…Ø© Ø¬Ù‡Ø§Ø²Ùƒ: " + appDeviceId;

    // ==========================================
    // ğŸ“‹ Ø¯Ø§Ù„Ø© Ø§Ù„Ù„ØµÙ‚ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© (Clipboard API)
    // ==========================================
    async function pasteCode() {
        try {
            const text = await navigator.clipboard.readText();
            if(text) {
                document.getElementById('subCode').value = text.trim();
                // ØªØ£Ø«ÙŠØ± Ù…Ø±Ø¦ÙŠ Ø¨Ø³ÙŠØ· Ø¹Ù†Ø¯ Ù†Ø¬Ø§Ø­ Ø§Ù„Ù„ØµÙ‚
                document.getElementById('subCode').style.borderColor = "#00e676";
                setTimeout(() => document.getElementById('subCode').style.borderColor = "#555", 500);
            }
        } catch (err) {
            // ÙÙŠ Ø­Ø§Ù„ ÙƒØ§Ù† Ø§Ù„Ù…ØªØµÙØ­ Ø£Ùˆ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠÙ…Ù†Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø§ÙØ¸Ø©
            alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø·Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø§ÙØ¸Ø© Ø£Ùˆ Ù‚Ù… Ø¨Ø§Ù„Ù„ØµÙ‚ ÙŠØ¯ÙˆÙŠØ§Ù‹.");
        }
    }

    // ==========================================
    // ğŸ“¦ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ù… Ù†Ø¹Ø¯ Ù†Ø­ØªØ§Ø¬ Ù„ØªØ­Ø¯ÙŠØ¯ ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ ØµØ±ÙŠØ­ (expiryDate)ØŒ Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹.
    // ==========================================
    const subscriptionCodes = {
        "WEEK-1111": { duration: "7days", status: 1, deviceId: "" },
        "MONTH-HACK": { duration: "30days", status: 2, deviceId: "" }, // âš ï¸ Ù…Ø­Ø¸ÙˆØ±
        "hamzazed123": { duration: "30days", status: 1, deviceId: "a1b2c3d4e5f6" }, 
        "SUB-MONTH": { duration: "30days", status: 1, deviceId: "" }, 
        "SUB-DAY": { duration: "1day", status: 1, deviceId: "b2c8cdd53aba1104" }, 
        "SUB-HOUR": { duration: "1hour", status: 1, deviceId: "" }, 
        "TEST-20SEC": { duration: "20seconds", status: 1, deviceId: "" }, 
        "VIP-FUTURE": { duration: "lifetime", status: 1, deviceId: "" } 
    };

    // ==========================================
    // â±ï¸ Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø©)
    // ==========================================
    function calculateExpiryTime(durationStr) {
        let ms = 0;
        let match = durationStr.match(/(\d+)/); // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ù†Øµ
        let val = match ? parseInt(match[0]) : 0;

        if (durationStr.includes("day")) {
            ms = val * 24 * 60 * 60 * 1000;
        } else if (durationStr.includes("hour")) {
            ms = val * 60 * 60 * 1000;
        } else if (durationStr.includes("sec")) {
            ms = val * 1000;
        } else if (durationStr.includes("lifetime")) {
            ms = 100 * 365 * 24 * 60 * 60 * 1000; // 100 Ø³Ù†Ø© ÙƒÙ…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©
        }

        return Date.now() + ms; // Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ + Ø§Ù„Ù…Ø¯Ø©
    }

    // ==========================================
    // ğŸ”„ Ø£ÙˆØ§Ù…Ø± Ø§Ù„ÙØ­Øµ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
    // ==========================================
    window.onload = function() {
        // ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«
        setTimeout(function() {
            window.location.href = "app://check_update?req_ver=" + REQUIRED_APP_VERSION + "&link=" + encodeURIComponent(DEVELOPER_LINK);
        }, 300);

        // ÙØ­Øµ Ø§Ù„Ø­Ø¸Ø±
        if (checkCode !== "") {
            if (subscriptionCodes[checkCode] && subscriptionCodes[checkCode].status === 2) {
                setTimeout(function() {
                    window.location.href = "app://ban_user?link=" + encodeURIComponent(DEVELOPER_LINK);
                }, 600);
            }
        } 
        // Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ø§Ø°Ø§ Ø£Ø±Ø³Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ ØµØ§Ù„Ø­)
        else if (checkCode === "" && appDeviceId !== "UNKNOWN" && appExpiryParam) {
            let expiryMs = parseInt(appExpiryParam);
            if (expiryMs > Date.now()) {
                document.getElementById('mainCard').innerHTML = `
                    <h2 style='color:#00e676;'>Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ø´ØªØ±Ø§ÙƒÙƒ... ğŸ”„</h2>
                    <p style='color:#ccc;font-size:14px;'>ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²ÙƒØŒ Ø§Ù†ØªØ¸Ø± Ù„Ø­Ø¸Ø©</p>
                    <div style="margin-top:20px; width:40px; height:40px; border:4px solid #00e676; border-top:4px solid transparent; border-radius:50%; animation: spin 1s linear infinite; margin-left:auto; margin-right:auto;"></div>
                    <style>@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</style>
                `;
                
                setTimeout(function() {
                    window.location.href = `app://restore_sub?expiry_time=${expiryMs}`;
                }, 2000);
            }
        }
    };

    // ==========================================
    // ğŸ” Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (ÙˆØ­Ø³Ø§Ø¨ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡)
    // ==========================================
    function login() {
        const subCode = document.getElementById('subCode').value.trim();
        const codeData = subscriptionCodes[subCode];
        const errorDiv = document.getElementById('error');

        if (codeData) {
            if (codeData.status === 2) {
                errorDiv.innerText = "ØªÙ… Ø­Ø¸Ø± Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø·ÙˆØ±! ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù….";
                errorDiv.style.display = 'block';
            } 
            else if (codeData.deviceId !== "" && codeData.deviceId !== appDeviceId) {
                errorDiv.innerText = "â›” Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø®ØµØµ Ù„Ù‡Ø§ØªÙ Ø¢Ø®Ø± ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²!";
                errorDiv.style.display = 'block';
            }
            else if (codeData.status === 1) {
                errorDiv.style.display = 'none';
                
                // 1. Ø­Ø³Ø§Ø¨ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø¯Ø© Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
                const expiryTimeMs = calculateExpiryTime(codeData.duration);
                
                // 2. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„ÙŠÙ‚ÙˆÙ… Ø¨Ø­ÙØ¸Ù‡Ø§ ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
                window.location.href = `app://success_auth?code=${subCode}&duration=${codeData.duration}&expiry_time=${expiryTimeMs}`;
                
                // 3. ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const btn = document.querySelector('.main-btn');
                btn.innerText = "ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…";
                btn.style.background = "#fff";
                btn.disabled = true;
            }
        } else {
            errorDiv.innerText = "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!";
            errorDiv.style.display = 'block';
        }
    }
</script>

</body>
</html>
