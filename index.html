<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0b1121">
    
    <title>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ | Ù†Ø¸Ø§Ù… Ù…Ø­Ù…ÙŠ</title>
    <style>
        :root {
            --bg-color: #0b1121;
            --card-bg: #151c2c;
            --primary: #10b981;
            --primary-dark: #059669;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --input-bg: #1e293b;
            --border-color: #334155;
        }

        body { 
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-main); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            -webkit-user-select: none;
            user-select: none; 
            -webkit-touch-callout: none; 
            -webkit-user-drag: none; 
            touch-action: manipulation; 
            -webkit-tap-highlight-color: transparent;
            overflow: hidden;
        }

        .app-container { 
            background: var(--card-bg); 
            padding: 40px 24px; 
            border-radius: 28px; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); 
            width: 85%; 
            max-width: 340px; 
            text-align: center; 
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .app-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 18px;
            margin: 0 auto 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.2);
        }

        h2 { margin: 0 0 8px 0; font-size: 22px; font-weight: 700; letter-spacing: -0.5px; }
        p.subtitle { font-size: 14px; color: var(--text-muted); margin: 0 0 30px 0; }
        
        .input-wrapper { position: relative; margin-bottom: 24px; width: 100%; }
        
        input { 
            width: 100%; 
            padding: 16px 85px 16px 16px; 
            border-radius: 16px; 
            border: 1.5px solid var(--border-color); 
            background: var(--input-bg); 
            color: var(--primary); 
            box-sizing: border-box; 
            text-align: center; 
            font-family: monospace; 
            font-size: 18px; 
            font-weight: 700; 
            letter-spacing: 2px; 
            transition: all 0.3s ease; 
        }
        
        input:focus { 
            outline: none; 
            border-color: var(--primary); 
            background: #192b38; 
        }
        input::placeholder { color: #64748b; font-weight: normal; letter-spacing: normal; }
        
        .paste-btn { 
            position: absolute; 
            right: 8px; 
            top: 50%; 
            transform: translateY(-50%); 
            background: rgba(255, 255, 255, 0.1); 
            color: var(--text-main); 
            border: none; 
            border-radius: 10px; 
            padding: 8px 12px; 
            font-size: 13px; 
            cursor: pointer; 
            font-weight: 600; 
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .paste-btn:active { background: var(--primary); color: #000; transform: translateY(-50%) scale(0.95); }

        button.main-btn { 
            width: 100%; 
            padding: 16px; 
            background: linear-gradient(135deg, var(--primary), var(--primary-dark)); 
            border: none; 
            border-radius: 16px; 
            color: #ffffff; 
            font-weight: 700; 
            font-size: 16px; 
            cursor: pointer; 
            transition: all 0.2s; 
            margin-bottom: 12px;
            box-shadow: 0 8px 16px rgba(16, 185, 129, 0.2);
        }
        button.main-btn:active { transform: scale(0.96); box-shadow: 0 4px 8px rgba(16, 185, 129, 0.2); }
        
        .whatsapp-btn { 
            background: rgba(37, 211, 102, 0.1); 
            color: #25D366; 
            text-decoration: none; 
            display: flex; 
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 14px; 
            border-radius: 16px; 
            font-weight: 600; 
            font-size: 14px; 
            transition: all 0.2s; 
        }
        .whatsapp-btn:active { background: rgba(37, 211, 102, 0.2); transform: scale(0.96); }
        
        .error { 
            color: #ef4444; 
            font-size: 13px; 
            margin-top: 16px; 
            display: none; 
            padding: 12px; 
            border-radius: 12px; 
            background: rgba(239, 68, 68, 0.1); 
            font-weight: 600; 
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; 
        }
        
        .device-info { 
            font-size: 11px; 
            color: var(--text-muted); 
            margin-top: 24px; 
            font-family: monospace; 
            opacity: 0.7;
        }
        
        @keyframes slideUp {
            0% { transform: translateY(30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .spinner {
            width: 40px; 
            height: 40px; 
            border: 4px solid rgba(16, 185, 129, 0.2); 
            border-top: 4px solid var(--primary); 
            border-radius: 50%; 
            animation: spin 1s linear infinite; 
            margin: 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="app-container" id="mainCard">
    <div class="app-icon">ğŸ›¡ï¸</div>
    <h2>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
    <p class="subtitle">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ùˆ Ù„ØµÙ‚ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</p>
    
    <div class="input-wrapper">
        <input type="text" id="subCode" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§..." autocomplete="off" autocorrect="off" spellcheck="false">
        <button class="paste-btn" onclick="pasteCode()">
            <span>Ù„ØµÙ‚</span>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
        </button>
    </div>

    <button class="main-btn" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
    
    <a href="https://wsend.co/905424678123" class="whatsapp-btn" target="_blank">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
        Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†
    </a>
    
    <div id="error" class="error">Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ØŒ Ù…Ù†ØªÙ‡ÙŠØŒ Ø£Ùˆ Ù…Ø­Ø¸ÙˆØ±!</div>
    
    <div class="device-info" id="deviceDisplay">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¨ØµÙ…Ø© Ø§Ù„Ù‡Ø§ØªÙ...</div>
</div>

<script>
    // ==========================================
    // ğŸ›¡ï¸ Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© 
    // ==========================================
    document.addEventListener('contextmenu', event => event.preventDefault());
    document.onkeydown = function(e) {
        if (e.keyCode === 123 || 
           (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74)) || 
           (e.ctrlKey && e.keyCode === 85)) {
            return false;
        }
    };

    // ==========================================
    // âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    // ==========================================
    const REQUIRED_APP_VERSION = "3.0.1"; 
    const DEVELOPER_LINK = "https://wsend.co/905424678123";

    const urlParams = new URLSearchParams(window.location.search);
    const appDeviceId = urlParams.get('device_id') || "UNKNOWN";
    const checkCode = urlParams.get('check_code') || "";
    const appExpiryParam = urlParams.get('expiry_time') || null; 
    
    document.getElementById('deviceDisplay').innerText = "DEVICE ID: " + appDeviceId;

    // ==========================================
    // ğŸ“‹ Ø¯Ø§Ù„Ø© Ø§Ù„Ù„ØµÙ‚
    // ==========================================
    async function pasteCode() {
        try {
            if (navigator.clipboard && navigator.clipboard.readText) {
                const text = await navigator.clipboard.readText();
                if(text) applyPastedText(text);
            } else {
                fallbackPaste();
            }
        } catch (err) {
            fallbackPaste();
        }
    }

    function fallbackPaste() {
        let pastedText = prompt("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù„ØµÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§ ÙˆØ§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø­Ø³Ù†Ø§Ù‹:", "");
        if (pastedText !== null && pastedText.trim() !== "") {
            applyPastedText(pastedText);
        }
    }

    function applyPastedText(text) {
        let inputField = document.getElementById('subCode');
        inputField.value = text.trim();
        inputField.style.borderColor = "var(--primary)";
        setTimeout(() => inputField.style.borderColor = "var(--border-color)", 500);
    }

    // ==========================================
    // ğŸ“¦ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ 
    // Ø§Ù„Ø¢Ù†ØŒ ÙÙ‚Ø· Ø¶Ø¹ Ø§Ù„Ù…Ø¯Ø© (duration)ØŒ ÙˆØ§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠØªÙƒÙÙ„ Ø¨Ø§Ù„Ø¨Ø§Ù‚ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹!
    // ==========================================
    const subscriptionCodes = {
        "WEEK-1111": { duration: "7days", status: 1 },
        "MONTH-HACK": { duration: "30days", status: 2 }, 
        "SUB-MONTH": { duration: "30days", status: 1 }, 
        "SUB-DAY": { duration: "1day", status: 1 }, 
        "SUB-HOUR": { duration: "1hour", status: 1 }, 
        "TEST-20SEC": { duration: "20seconds", status: 1 }, 
        "VIP-FUTURE": { duration: "lifetime", status: 1 } 
    };

    // ==========================================
    // â±ï¸ Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯Ø© Ø¨Ø§Ù„Ù…Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©
    // ==========================================
    function getDurationMs(durationStr) {
        let ms = 0;
        let match = durationStr.match(/(\d+)/);
        let val = match ? parseInt(match[0]) : 0;

        if (durationStr.includes("day")) ms = val * 24 * 60 * 60 * 1000;
        else if (durationStr.includes("hour")) ms = val * 60 * 60 * 1000;
        else if (durationStr.includes("sec")) ms = val * 1000;
        else if (durationStr.includes("lifetime")) ms = 100 * 365 * 24 * 60 * 60 * 1000;

        return ms;
    }

    // ==========================================
    // ğŸ”„ Ø£ÙˆØ§Ù…Ø± Ø§Ù„ÙØ­Øµ Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
    // ==========================================
    window.onload = function() {
        setTimeout(function() {
            window.location.href = "app://check_update?req_ver=" + REQUIRED_APP_VERSION + "&link=" + encodeURIComponent(DEVELOPER_LINK);
        }, 300);

        if (checkCode !== "") {
            if (subscriptionCodes[checkCode] && subscriptionCodes[checkCode].status === 2) {
                setTimeout(function() {
                    window.location.href = "app://ban_user?link=" + encodeURIComponent(DEVELOPER_LINK);
                }, 600);
            }
        } 
        else if (checkCode === "" && appDeviceId !== "UNKNOWN" && appExpiryParam) {
            let expiryMs = parseInt(appExpiryParam);
            if (expiryMs > Date.now()) {
                document.getElementById('mainCard').innerHTML = `
                    <div class="app-icon" style="background: transparent; box-shadow: none; font-size:40px;">ğŸ”„</div>
                    <h2 style='color:var(--text-main);'>Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ø´ØªØ±Ø§ÙƒÙƒ...</h2>
                    <p style='color:var(--text-muted);font-size:14px;'>ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²ÙƒØŒ Ø§Ù†ØªØ¸Ø± Ù„Ø­Ø¸Ø©</p>
                    <div class="spinner"></div>
                `;
                setTimeout(function() {
                    window.location.href = `app://restore_sub?expiry_time=${expiryMs}`;
                }, 2000);
            }
        }
    };

    // ==========================================
    // ğŸ” Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    // ==========================================
    function login() {
        const subCode = document.getElementById('subCode').value.trim();
        const codeData = subscriptionCodes[subCode];
        const errorDiv = document.getElementById('error');

        if (codeData) {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¸Ø±
            if (codeData.status === 2) {
                errorDiv.innerText = "ØªÙ… Ø­Ø¸Ø± Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø·ÙˆØ±! ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù….";
                errorDiv.style.display = 'block';
                return;
            }

            // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© (Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ) ---
            let memoryKey = "SAVED_CODE_" + subCode;
            let savedData = JSON.parse(localStorage.getItem(memoryKey));
            
            let finalExpiryTime = 0;

            // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ù‡Ø°Ø§ Ø£ÙˆÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù‡)
            if (!savedData) {
                finalExpiryTime = Date.now() + getDurationMs(codeData.duration);
                // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø² ÙˆÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ù„ØªØ«Ø¨ÙŠØªÙ‡Ø§
                let newData = {
                    deviceId: appDeviceId,
                    expiryTime: finalExpiryTime
                };
                localStorage.setItem(memoryKey, JSON.stringify(newData));
            } 
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù…Ø§Ù‹ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©)
            else {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø°ÙŠ ÙŠØ³ØªØ®Ø¯Ù…Ù‡ Ù‡Ùˆ Ù†ÙØ³ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø°ÙŠ ÙØ¹Ù„Ù‡ Ø£ÙˆÙ„ Ù…Ø±Ø©
                if (savedData.deviceId !== appDeviceId && savedData.deviceId !== "UNKNOWN") {
                    errorDiv.innerText = "â›” Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø®ØµØµ Ù„Ù‡Ø§ØªÙ Ø¢Ø®Ø± (ØªÙ… ØªÙØ¹ÙŠÙ„Ù‡ Ù…Ø³Ø¨Ù‚Ø§Ù‹) ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²!";
                    errorDiv.style.display = 'block';
                    return;
                }
                finalExpiryTime = savedData.expiryTime; // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ø¹Ø·Ø§Ø¡ ÙˆÙ‚Øª Ø¬Ø¯ÙŠØ¯
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ù‚Ø¯ Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚ØªÙ‡ ÙØ¹Ù„ÙŠØ§Ù‹
            if (finalExpiryTime < Date.now()) {
                errorDiv.innerText = "Ù„Ù‚Ø¯ Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯!";
                errorDiv.style.display = 'block';
                return;
            }

            // Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­
            errorDiv.style.display = 'none';
            window.location.href = `app://success_auth?code=${subCode}&duration=${codeData.duration}&expiry_time=${finalExpiryTime}`;
            
            const btn = document.querySelector('.main-btn');
            btn.innerText = "ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…";
            btn.style.background = "var(--primary)";
            btn.disabled = true;

        } else {
            errorDiv.innerText = "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!";
            errorDiv.style.display = 'block';
        }
    }
</script>

</body>
</html>
